---
title: قطار اسباب بازی
layout: CF
---


آليس يک مجموعه ي قطار اسباب بازي از باب گرفته است. اين جعبه شامل يک قطار و يک شبکه ي ريلي شامل $n$ ايستگاه است که از $1$ تا $n$ نام گذاري شده اند. قطار در يک لحظه ي خاص يک ايستگاه را اشغال ميکند و به طور دايره اي اطراف شبکه ي ريلي سفر ميکند. به عبارتي ديگر ايستگاهي که قطار بعد ايستگاه $i$ به آن ميرسد به ازاي $1 \leq i < n$ ، $i+1$ است. و در صورتي که $i=n$ آنگاه ايستگاه بعد آن ايستگاه $1$ است. رفتن از يک ايستگاه به ايستگاه بعدش $1$ ثانيه زمان ميبرد.

باب قبل از اينکه برود به اليس يک مسئله ي جذاب داده است: رساندن $m$ آبنبات به مقصد مستقلشان که در ابتدا در برخي ايستگاه ها هستند. آبنبات ها از $1$ تا $m$ نامگذاري شده اند. آبنبات $i$ $(1 \leq i \leq m)$  که در حال حاضر در ايستگاه $a_i$ است، بايد به ايستگاه $b_i$ ($a_i \neq b_i$) انتقال يابد.

![image description](http://uupload.ir/files/5ikn_06d54688e1fe32e557380135a44a4ef5220fd0a0.png)

در شکل بالا اعداد آبي روي آبنبات ها مطابقت دارد با مقادير $b_i$. اين شکل شکل مربوط به نمونه $1$ است.

گنجايش قطار بينهات است و ممکن است در يک ايستگاه تعداد متفاوتي آبنبات را بارگزاري کند. با اين حال، **حداکثر يک** آبنبات ميتواند در يک ايستگاه بارگيري شود. شما ميتواند در يک ايستگاه هر آبنباتي را به دلخواه براي بارگيري انتخاب کنيد. زماني که براي بارگزاري و بارگيري آبنبات ها صرف ميشود ناچيز است.

حال آليس ميخواهد بداند چقدر زمان براي قطار لازم است تا بتواند همه ي آبنبات ها را به مقصد دلخواه منتقل کند. وظيفه ي شما اين است که به ازاي هر ايستگاه کمترين زماني را محاسبه کنيد که در صورتي که قطار از آن ايستگاه شروع به حرکت کند بتواند تمام آبنبات ها را به مقصد برساند.

# ورودي

خط اول شامل دو عدد $n$ و $m$ است ($1 \leq m \leq 20\,000$ ; $2 \leq n \leq 5\,000$) — که به ترتيب تعداد ايستگاه ها و تعداد آبنبات ها هستند.

در ادامه در $i$امين خط ورودي دو عدد $a_i$ و $b_i$ مي آيد ($a_i \neq b_i$ ;$1 \leq a_i, b_i \leq n$)  — که به ترتيب برابرند با ايستگاهي که در  ابتدا آبنبات شماره ي $i$ در آن قرار دارد و مقصدي که اين آبنبات در نهايت بايد به آن برسد.

# خروجي

در تنها خط خروجي $n$ عدد چاپ کنيد که با فاصله از هم قرار دارند. $i$امين عدد آنها بايد کمترين زمان (به ثانيه) باشد که لازم است تا بتوانيم تمام آبنبات ها را به مقصدشان برسانيم در صورتي که از ايستگاه شماره ي $i$ شروع کنيم.

# نمونه ها

نمونه ي 1:

ورودي

    5 7
    2 4
    5 1
    2 3
    3 4
    4 1
    5 3
    3 5

خروجي

    10 9 10 10 9 

نمونه 2

ورودي

    2 3
    1 2
    1 2
    1 2

خروجي

    5 6 

**توضيحات**

نمونه ي 2 را در نظر بگيريد:

اگر قطار از ايستگاه 1 شروع به حرکت کند، راه حل بهينه به صورت زير است:

1. بارگيري آبنبات شماره 1.

2. رفتن به ايستگاه شماره 2 . اين عمل 1 ثانيه زمان ميبرد.

3. بارگزاري آبنبات شماره 1.

4. رفتن به ايستگاه شماره 1 . اين عمل 1 ثانيه زمان ميبرد.

5. بارگيري آبنبات شماره 2.

6. رفتن به ايستگاه شماره 2 . اين عمل 1 ثانيه زمان ميبرد.

7. بارگزاري آبنبات شماره 2.

8. رفتن به ايستگاه شماره 1 . اين عمل 1 ثانيه زمان ميبرد.

9. بارگيري آبنبات شماره 3.

10. رفتن به ايستگاه شماره 2 . اين عمل 1 ثانيه زمان ميبرد.

11.  بارگزاري آبنبات شماره 3.

در نتيجه قطار 5 ثانيه براي رسيدن به هدف خودش زمان لازم دارد. 

اگر قطار از ايستگاه شماره 2 شروع کند، در هر حال نياز دارد به ايستگاه شماره يک برود براي ايکه اولين آبنبات را بردارد، که اين عمل 1 ثانيه زمان ميبرد. در نتيجه جواب براي اين قسمت $5+1 = 6$ ثانيه است.
